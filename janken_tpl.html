<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script src="js/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/janken.css">
    <title>じゃんけん</title>
</head>

<body>
<!-- 残課題として、PC単位でのフォントsizeが調整できていないこと
永久ループ処理みたいになったところをどうするかは検討の価値あり -->

    <header>
        <h1>じゃんけん</h1>
        <p id="win_lose"></p>
    </header>

    <main>
        <ul id="me">
            <li class="me" id="gu_btn"><p>グー</p></li>
            <li class="me" id="cho_btn"><p>チョキ</p></li>
            <li class="me" id="par_btn"><p>パー</p></li>
        </ul>
        <ul id="aite">
            <li class="aite" id="aite_gu_btn"><p>グー</p></li>
            <li class="aite" id="aite_cho_btn"><p>チョキ</p></li>
            <li class="aite" id="aite_par_btn"><p>パー</p></li>
        </ul>
        <div id="judgement">勝ち</div>
    </main>

    <footer id="footer">
        <div id="save">Save</div>
        <div id="next">footer@janken.co.jp</div>
        <div id="reset">Reset</div>        
    </footer>

    <script>
        // 初期設定の画面レイアウト
        function init(){
            $("#aite").css("display","none");
            $("#reset").css("display","none");
            $("#save").css("display","none");
            $(".me").css("width","22.5vw");
            $(".me").css("height","22.5vw");
            $(".aite").css("color","black");
            $("#judgement").css("display","none");
            $("#next").html("footer@janken.co.jp")
            $("#next").off("click");
            $(".me").css("backgroundColor","#bdbdbd");
            $(".aite").css("backgroundColor","#bdbdbd");
            g();
            c();
            p();
        }

            // 画面表示を定義する
            function ans(){
            $("#aite").css("display","flex");
            $(".me").css("width","10.5vw");
            $(".me").css("height","10.5vw");
            $(".aite").css("width","10.5vw");
            $(".aite").css("height","10.5vw");
        }
        function aite_gu(){
            $("#aite_gu_btn").css("backgroundColor","rgb(238, 163, 188)");
            $("#aite_gu_btn").css("color","white");
            $("#aite_gu_btn").css("fontWeight","bold");

            $("#judgement").css("display","block");
            // サイズ指定方法について知りたい
            // $("#judgement").css("fontSize","50px");
        }
        function aite_par(){
            $("#aite_par_btn").css("backgroundColor","rgb(238, 163, 188)");
            $("#aite_par_btn").css("color","white");
            $("#aite_par_btn").css("fontWeight","bold");

            $("#judgement").css("display","block");
        }
        function aite_cho(){
            $("#aite_cho_btn").css("backgroundColor","rgb(238, 163, 188)");
            $("#aite_cho_btn").css("color","white");
            $("#aite_cho_btn").css("fontWeight","bold");

            $("#judgement").css("display","block");
        }
    
    //ホバーオフにする記載
        function hover_off(){
            $("#gu_btn").off('mouseenter mouseleave');
            $("#par_btn").off('mouseenter mouseleave');
            $("#cho_btn").off('mouseenter mouseleave');
        }

    // リセット処理について記載
        function reset(){
            init();
            win = 0;
            lose = 0;
            draw = 0;
            $("#win_lose").html(win+"勝"+lose+"敗"+draw+"分");
        }
    // レイアウト調整（最終調整）
        function g(){
        $("#gu_btn").hover(function(){
                    // over
                    $("#gu_btn").css("backgroundColor","#0066CC");
                    $("#gu_btn").css("color","white");
                }, function () {
                    // out
                    $("#gu_btn").css("backgroundColor","#bdbdbd");
                    $("#gu_btn").css("color","black");
                }
            );
        }
        function c(){
        $("#cho_btn").hover(function(){
                    // over
                    $("#cho_btn").css("backgroundColor","#0066CC");
                    $("#cho_btn").css("color","white");
                }, function () {
                    // out
                    $("#cho_btn").css("backgroundColor","#bdbdbd");
                    $("#cho_btn").css("color","black");
                }
            );
        }
        function p(){
        $("#par_btn").hover(function(){
                    // over
                    $("#par_btn").css("backgroundColor","#0066CC");
                    $("#par_btn").css("color","white");
                }, function () {
                    // out
                    $("#par_btn").css("backgroundColor","#bdbdbd");
                    $("#par_btn").css("color","black");
                }
            );
        }
        
        // 初期設定 
        init()
        let result = "";
        let win = 0;
        let lose = 0;
        let draw = 0;

        // グーに関する記載
         $("#gu_btn").on("click",function(){
            $("#reset").css("display","none");
            $("#save").css("display","none");
            $("#gu_btn").css("backgroundColor","#0066CC");
            hover_off();
            // $("#par_btn").off("click");
            // $("#cho_btn").off("click");
            $("#next").on("click");

            const r = Math.ceil(Math.random()*3);
            if(r==1){
                ans();
                aite_gu();
                result = "引き分け";
                draw ++;
            }else if(r==2){
                ans();
                aite_par();
                result = "負け";
                lose ++;
            }else{
                ans();
                aite_cho();
                result = "勝ち";
                win ++;
            }
            $("#judgement").html(result);
            $("#win_lose").html(win+"勝"+lose+"敗"+draw+"分");
            $("#next").html("Next");

            $("#next").on("click",function(){
                init();
                $("#reset").css("display","block");
                $("#save").css("display","block");
                $("#gu_btn").css("backgroundColor","#bdbdbd");
                $("#gu_btn").css("color","black");
                if(r==1){
                    $("#aite_gu_btn").css("backgroundColor","#bdbdbd");
                }else if(r==2){
                    $("#aite_par_btn").css("backgroundColor","#bdbdbd");
                }else{
                    $("#aite_cho_btn").css("backgroundColor","#bdbdbd");
                }
            });
            // resetボタンの記載
            $("#reset").on("click",function(){
                reset();
            });
        });

        // パーに関する記載
         $("#par_btn").on("click",function(){
            $("#reset").css("display","none");
            $("#save").css("display","none");
            $("#par_btn").css("backgroundColor","#0066CC");
            hover_off();
            // $("#gu_btn").off("click");
            // $("#cho_btn").off("click");
            $("#next").on("click");

            const r = Math.ceil(Math.random()*3);
            if(r==1){
                ans();
                aite_gu();
                result = "勝ち";
                win ++;
            }else if(r==2){
                ans();
                aite_par();
                result = "引き分け";
                draw ++;
            }else{
                ans();
                aite_cho();
                result = "負け";
                lose ++;
            }
            $("#judgement").html(result);
            $("#win_lose").html(win+"勝"+lose+"敗"+draw+"分")
            $("#next").html("Next");

            $("#next").on("click",function(){
                init();
                $("#reset").css("display","block");
                $("#save").css("display","block");
                $("#par_btn").css("backgroundColor","#bdbdbd");
                $("#par_btn").css("color","black");
                if(r==1){
                    $("#aite_gu_btn").css("backgroundColor","#bdbdbd");
                }else if(r==2){
                    $("#aite_par_btn").css("backgroundColor","#bdbdbd");
                }else{
                    $("#aite_cho_btn").css("backgroundColor","#bdbdbd");
                }
            });
            $("#reset").on("click",function(){
                reset();
            });
        });

        // チョキ「に関する記載
         $("#cho_btn").on("click",function(){
            $("#reset").css("display","none");
            $("#save").css("display","none");
            $("#cho_btn").css("backgroundColor","#0066CC");
            hover_off();
            // $("#par_btn").off("click");
            // $("#gu_btn").off("click");
            $("#next").on("click");

            const r = Math.ceil(Math.random()*3);
            if(r==1){
                ans();
                aite_gu();
                result = "負け";
                lose ++;
            }else if(r==2){
                ans();
                aite_par();
                result = "勝ち";
                win ++;
            }else{
                ans();
                aite_cho();
                result = "引き分け";
                draw ++;
            }
            $("#judgement").html(result);
            $("#win_lose").html(win+"勝"+lose+"敗"+draw+"分");
            $("#next").html("Next");

            $("#next").on("click",function(){
                init();
                $("#reset").css("display","block");
                $("#save").css("display","block");
                $("#cho_btn").css("backgroundColor","#bdbdbd");
                $("#cho_btn").css("color","black");
                if(r==1){
                    $("#aite_gu_btn").css("backgroundColor","#bdbdbd");
                }else if(r==2){
                    $("#aite_par_btn").css("backgroundColor","#bdbdbd");
                }else{
                    $("#aite_cho_btn").css("backgroundColor","#bdbdbd");
                }
            });
            $("#reset").on("click",function(){
                reset(); 
            });
        });

        $("#save").on("click",function(){
                let value = {
                    "win" : win,
                    "lose" : lose,
                    "draw" : draw
                };
                let v = JSON.stringify(value);
                console.log(v);
                localStorage.setItem("victory",v);
                alert("saveしました");
        });

        
   
    </script>
</body>

</html>